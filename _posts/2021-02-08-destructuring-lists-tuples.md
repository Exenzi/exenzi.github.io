---
layout: post
title:  "Распаковка списков и картежей"
date:   2021-02-08 19:06:22 +0300
author: Макс Рокицкий
tags: python tuple list destructure
permalink: destructuring-lists-tuples
---

Одной из полезных фишек Python является деструктуризация списков и картежей. Её также называют распаковкой. Распаковка позволяет в одной строчке присвоить значения сразу нескольким переменным.

Допустим, у нас есть картеж с параметрами цвета RGB `color = (66, 184, 96)`, с которым мы потом делаем много вычислений и писать код в стиле `color[0], color[1]...` может ухудшить читаемость и мы будем постоянно путаться, где тут красный, где зелёный и синий. 

Нам будет намного проще раскидать эти значения по переменным `red`, `green`, `blue`:

```python
red = color[0]
green = color[1]
blue = color[2]
```

Благодаря распаковке мы можем записать тоже самое в одну строчку:

```python
red, green, blue = color
```

<!--more-->

В данном случае интерпретатор распакует картеж `color` и присвоит значения элементов переменным. Главное, чтобы количество переменных слева было равно количеству переменных справа. Если это условие не будет выполнено, то интерпретатор выкинет исключения типа `ValueError`.

Тоже самое можно делать и со списками:

```python
students = ['Alex', 'Josh', 'Will']
first, second, third = students
```

Необязательно указывать переменную, ссылающуюся на картеж/список. Можно указывать элементы через запятую.

```python
red, green, blue = color[0], color[1], color[2]
```

Благодаря такому трюку, очень удобно обменивать две и более переменных значениями:

```python
a = 1
b = 2

a, b = b, a
# Результат: a = 2, b = 1
```

Магия состоит в том, что Python не высчитывает все элементы по очереди (напр. a = b, а потом b = a), а сначала высчитывает всё справа от знака равно, а потом присваивает переменным слева.

Также, если вы когда-нибудь писали `for key, value in array.items()`, то значит вы уже сталкивались с распаковкой. `.items()` при каждой итерации возвращает картеж из двух элементов: ключа и значения. И мы распаковываем их на две разные переменные.

## Запаковка значений

Интересной фишкой Python является возможность функций передавать сразу несколько значений с помощью `return`:

```python
def func(num):
    sq = num ** 2
    db = num * 2
    return sq, db

squared, doubled = func(4)
```

Под капотом, Python запаковывает `sq` и `db` в картеж и возвращает его. А потом мы сразу же его распаковываем на две переменные.

## Распаковываем выборочно

Если нам не нужны некоторые возвращаемые значения, то чтобы не создавать ненужные переменные, можно указать специальную переменную `_`. Например, если в примере выше нам не нужно первое значение `sq`, то мы можем его никуда не записывать так:

```python
_, doubled = func(4)
```

`_` - специальная переменная, о которой поговорим как-нибудь в другой раз. Пока что мы просто используем её в качестве заглушки. 